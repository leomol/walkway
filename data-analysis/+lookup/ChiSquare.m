% criticalValue = ChiSquare(dof, alpha)
% 
% Biostatistical Analysis by Jerrold H Zar (5th edition).
% Table B.1: Critical Values of the Chi-Square (x^2) Distribution, page 672.

% 2023-08-09. Leonardo Molina.
% 2023-08-15. Last modified.
function criticalValue = ChiSquare(dof, alpha)
    persistent data alphas;
    if nargin < 2
        alpha = 0.05;
    end
    if isempty(data)
        alphas = [0.999, 0.995, 0.99, 0.975, 0.95, 0.90, 0.75, 0.50, 0.25, 0.10, 0.05, 0.025, 0.01, 0.005, 0.001];
        data = [
                 0.000,  0.000,  0.000,  0.001,  0.004,  0.016,  0.102,  0.455,  1.323,  2.706,  3.841,  5.024,  6.635,  7.879, 10.828
                 0.002,  0.010,  0.020,  0.051,  0.103,  0.211,  0.575,  1.386,  2.773,  4.605,  5.991,  7.378,  9.210, 10.597, 13.816
                 0.024,  0.072,  0.115,  0.216,  0.352,  0.584,  1.213,  2.366,  4.108,  6.251,  7.815,  9.348, 11.345, 12.838, 16.266
                 0.091,  0.207,  0.297,  0.484,  0.711,  1.064,  1.923,  3.357,  5.385,  7.779,  9.488, 11.143, 13.277, 14.860, 18.467
                 0.210,  0.412,  0.554,  0.831,  1.145,  1.610,  2.675,  4.351,  6.626,  9.236, 11.070, 12.833, 15.086, 16.750, 20.515
                 0.381,  0.676,  0.872,  1.237,  1.635,  2.204,  3.455,  5.348,  7.841, 10.645, 12.592, 14.449, 16.812, 18.548, 22.458
                 0.599,  0.989,  1.239,  1.690,  2.167,  2.833,  4.255,  6.346,  9.037, 12.017, 14.067, 16.013, 18.475, 20.278, 24.322
                 0.857,  1.344,  1.646,  2.180,  2.733,  3.490,  5.071,  7.344, 10.219, 13.362, 15.507, 17.535, 20.090, 21.955, 26.124
                 1.152,  1.735,  2.088,  2.700,  3.325,  4.168,  5.899,  8.343, 11.389, 14.684, 16.919, 19.023, 21.666, 23.589, 27.877
                 1.479,  2.156,  2.558,  3.247,  3.940,  4.865,  6.737,  9.342, 12.549, 15.987, 18.307, 20.483, 23.209, 25.188, 29.588
                 1.834,  2.603,  3.053,  3.816,  4.575,  5.578,  7.584, 10.341, 13.701, 17.275, 19.675, 21.920, 24.725, 26.757, 31.264
                 2.214,  3.074,  3.571,  4.404,  5.226,  6.304,  8.438, 11.340, 14.845, 18.549, 21.026, 23.337, 26.217, 28.300, 32.909
                 2.617,  3.565,  4.107,  5.009,  5.892,  7.042,  9.299, 12.340, 15.984, 19.812, 22.362, 24.736, 27.688, 29.819, 34.528
                 3.041,  4.075,  4.660,  5.629,  6.571,  7.790, 10.165, 13.339, 17.117, 21.064, 23.685, 26.119, 29.141, 31.319, 36.123
                 3.483,  4.601,  5.229,  6.262,  7.261,  8.547, 11.037, 14.339, 18.245, 22.307, 24.996, 27.488, 30.578, 32.801, 37.697
                 3.942,  5.142,  5.812,  6.908,  7.962,  9.312, 11.912, 15.338, 19.369, 23.542, 26.296, 28.845, 32.000, 34.267, 39.252
                 4.416,  5.697,  6.408,  7.564,  8.672, 10.085, 12.792, 16.338, 20.489, 24.769, 27.587, 30.191, 33.409, 35.718, 40.790
                 4.905,  6.265,  7.015,  8.231,  9.390, 10.865, 13.675, 17.338, 21.605, 25.989, 28.869, 31.526, 34.805, 37.156, 42.312
                 5.407,  6.844,  7.633,  8.907, 10.117, 11.651, 14.562, 18.338, 22.718, 27.204, 30.144, 32.852, 36.191, 38.582, 43.820
                 5.921,  7.434,  8.260,  9.591, 10.851, 12.443, 15.452, 19.337, 23.828, 28.412, 31.410, 34.170, 37.566, 39.997, 45.315
                 6.447,  8.034,  8.897, 10.283, 11.591, 13.240, 16.344, 20.337, 24.935, 29.615, 32.671, 35.479, 38.932, 41.401, 46.797
                 6.983,  8.643,  9.542, 10.982, 12.338, 14.041, 17.240, 21.337, 26.039, 30.813, 33.924, 36.781, 40.289, 42.796, 48.268
                 7.529,  9.260, 10.196, 11.689, 13.091, 14.848, 18.137, 22.337, 27.141, 32.007, 35.172, 38.076, 41.638, 44.181, 49.728
                 8.085,  9.886, 10.856, 12.401, 13.848, 15.659, 19.037, 23.337, 28.241, 33.196, 36.415, 39.364, 42.980, 45.559, 51.179
                 8.649, 10.520, 11.524, 13.120, 14.611, 16.473, 19.939, 24.337, 29.339, 34.382, 37.652, 40.646, 44.314, 46.928, 52.620
                 9.222, 11.160, 12.198, 13.844, 15.379, 17.292, 20.843, 25.336, 30.435, 35.563, 38.885, 41.923, 45.642, 48.290, 54.052
                 9.803, 11.808, 12.879, 14.573, 16.151, 18.114, 21.749, 26.336, 31.528, 36.741, 40.113, 43.195, 46.963, 49.645, 55.476
                10.391, 12.461, 13.565, 15.308, 16.928, 18.939, 22.657, 27.336, 32.620, 37.916, 41.337, 44.461, 48.278, 50.993, 56.892
                10.986, 13.121, 14.256, 16.047, 17.708, 19.768, 23.567, 28.336, 33.711, 39.087, 42.557, 45.722, 49.588, 52.336, 58.301
                11.588, 13.787, 14.953, 16.791, 18.493, 20.599, 24.478, 29.336, 34.800, 40.256, 43.773, 46.979, 50.892, 53.672, 59.703
                12.196, 14.458, 15.655, 17.539, 19.281, 21.434, 25.390, 30.336, 35.887, 41.422, 44.985, 48.232, 52.191, 55.003, 61.098
                12.811, 15.134, 16.362, 18.291, 20.072, 22.271, 26.304, 31.336, 36.973, 42.585, 46.194, 49.480, 53.486, 56.328, 62.487
                13.431, 15.815, 17.074, 19.047, 20.867, 23.110, 27.219, 32.336, 38.058, 43.745, 47.400, 50.725, 54.776, 57.648, 63.870
                14.057, 16.501, 17.789, 19.806, 21.664, 23.952, 28.136, 33.336, 39.141, 44.903, 48.602, 51.966, 56.061, 58.964, 65.247
                14.688, 17.192, 18.509, 20.569, 22.465, 24.797, 29.054, 34.336, 40.223, 46.059, 49.802, 53.203, 57.342, 60.275, 66.619
                15.324, 17.887, 19.233, 21.336, 23.269, 25.643, 29.973, 35.336, 41.304, 47.212, 50.998, 54.437, 58.619, 61.581, 67.985
                15.965, 18.586, 19.960, 22.106, 24.075, 26.492, 30.893, 36.336, 42.383, 48.363, 52.192, 55.668, 59.893, 62.883, 69.346
                16.611, 19.289, 20.691, 22.878, 24.884, 27.343, 31.815, 37.335, 43.462, 49.513, 53.384, 56.896, 61.162, 64.181, 70.703
                17.262, 19.996, 21.426, 23.654, 25.695, 28.196, 32.737, 38.335, 44.539, 50.660, 54.572, 58.120, 62.428, 65.476, 72.055
                17.916, 20.707, 22.164, 24.433, 26.509, 29.051, 33.660, 39.335, 45.616, 51.805, 55.758, 59.342, 63.691, 66.766, 73.402
                18.576, 21.421, 22.906, 25.215, 27.326, 29.907, 34.585, 40.335, 46.692, 52.949, 56.942, 60.561, 64.950, 68.053, 74.745
                19.239, 22.138, 23.650, 25.999, 28.144, 30.765, 35.510, 41.335, 47.766, 54.090, 58.124, 61.777, 66.206, 69.336, 76.084
                19.906, 22.859, 24.398, 26.785, 28.965, 31.625, 36.436, 42.335, 48.840, 55.230, 59.304, 62.990, 67.459, 70.616, 77.419
                20.576, 23.584, 25.148, 27.575, 29.787, 32.487, 37.363, 43.335, 49.913, 56.369, 60.481, 64.201, 68.710, 71.893, 78.750
                21.251, 24.311, 25.901, 28.366, 30.612, 33.350, 38.291, 44.335, 50.985, 57.505, 61.656, 65.410, 69.957, 73.166, 80.077
                21.929, 25.041, 26.657, 29.160, 31.439, 34.215, 39.220, 45.335, 52.056, 58.641, 62.830, 66.617, 71.201, 74.437, 81.400
                22.610, 25.775, 27.416, 29.956, 32.268, 35.081, 40.149, 46.335, 53.127, 59.774, 64.001, 67.821, 72.443, 75.704, 82.720
                22.295, 26.511, 28.177, 30.755, 33.098, 35.949, 41.079, 47.335, 54.196, 60.907, 65.171, 69.023, 73.683, 76.969, 84.037
        ];
    end
    
    nRows = size(data, 1);
    row = min(max(dof, 1), nRows);
    column = find(alpha <= alphas, 1, 'last');
    if isempty(column)
        column = 1;
    end
    criticalValue = data(row, column);
end