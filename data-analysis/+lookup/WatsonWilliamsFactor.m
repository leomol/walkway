% Table B.37: Correction Factor, K, for the Watson and Williams Test, page 847.
% Biostatistical Analysis by Jerrold H Zar (5th edition).
% 
% correctionFactor = WatsonWilliamsFactor(nSamples, u)

% 2023-08-18. Leonardo Molina.
% 2023-08-21. Last modified.
function correctionFactor = WatsonWilliamsFactor(nSamples, rw)
    persistent data rws sampleCounts;
    if isempty(data)
        data = [
                NaN, 188.4989, 94.7472, 63.5015, 47.8749, 38.4992, 32.2498, 27.7851, 24.4367, 21.8325
            19.7489,  18.0444, 16.6239, 15.4219, 14.3916, 13.4986, 12.7173, 12.0278, 11.4150, 10.8667
            10.3731,   9.9266,  9.5206,  9.1500,  8.8103,  8.4976,  8.2091,  7.9419,  7.6938,  7.4628
             7.2472,   7.0455,  6.8564,  6.6787,  6.5115,  6.3539,  6.2050,  6.0641,  5.9306,  5.8040
             5.6837,   5.5693,  5.4603,  5.3564,  5.2572,  5.1625,  5.0718,  4.9850,  4.9017,  4.8219
             4.7453,   4.6717,  4.6009,  4.5328,  4.4672,  4.4039,  4.3430,  4.2841,  4.2273,  4.1724
             4.1194,   4.0680,  4.0184,  3.9703,  3.9237,  3.8785,  3.8347,  3.7922,  3.7510,  3.7109
             3.6720,   3.6342,  3.5974,  3.5616,  3.5268,  3.4930,  3.4600,  3.4278,  3.3965,  3.3666
             3.3362,   3.3072,  3.2789,  3.2512,  3.2243,  3.1979,  3.1722,  3.1470,  3.1224,  3.0984
             3.0749,   3.0519,  3.0294,  3.0074,  2.9858,  2.9648,  2.9441,  2.9239,  2.9041,  2.8846
             2.8656,   2.8469,  2.8286,  2.8107,  2.7931,  2.7758,  2.7589,  2.7423,  2.7259,  2.7099
             2.6942,   2.6787,  2.6636,  2.6487,  2.6340,  2.6196,  2.6055,  2.5915,  2.5779,  2.5644
             2.5512,   2.5382,  2.5254,  2.5128,  2.5004,  2.4882,  2.4762,  2.4644,  2.4528,  2.4413
             2.4301,   2.4189,  2.4080,  2.3972,  2.3866,  2.3762,  2.3658,  2.3557,  2.3457,  2.3358
             2.3261,   2.3165,  2.3070,  2.2977,  2.2885,  2.2794,  2.2705,  2.2616,  2.2529,  2.2443
             2.2358,   2.2275,  2.2192,  2.2110,  2.2030,  2.1950,  2.1872,  2.1794,  2.1718,  2.1642
             2.1567,   2.1494,  2.1421,  2.1349,  2.1278,  2.1208,  2.1138,  2.1070,  2.1002,  2.0935
             2.0868,   2.0803,  2.0738,  2.0674,  2.0611,  2.0549,  2.0487,  2.0426,  2.0365,  2.0305
             2.0246,   2.0188,  2.0130,  2.0072,  2.0016,  1.9960,  1.9904,  1.9849,  1.9795,  1.9741
             1.9688,   1.9635,  1.9583,  1.9532,  1.9481,  1.9430,  1.9380,  1.9331,  1.9282,  1.9233
             1.9185,   1.9137,  1.9090,  1.9043,  1.8997,  1.8951,  1.8906,  1.8861,  1.8817,  1.8772
             1.8729,   1.8685,  1.8643,  1.8600,  1.8558,  1.8516,  1.8475,  1.8434,  1.8393,  1.8353
             1.8313,   1.8274,  1.8234,  1.8195,  1.8157,  1.8119,  1.8081,  1.8043,  1.8006,  1.7969
             1.7933,   1.7896,  1.7860,  1.7825,  1.7789,  1.7754,  1.7719,  1.7685,  1.7651,  1.7617
             1.7583,   1.7550,  1.7516,  1.7484,  1.7451,  1.7419,  1.7386,  1.7355,  1.7323,  1.7292
             1.7261,   1.7230,  1.7199,  1.7169,  1.7138,  1.7108,  1.7079,  1.7049,  1.7020,  1.6991
             1.6962,   1.6933,  1.6905,  1.6877,  1.6849,  1.6821,  1.6793,  1.6766,  1.6739,  1.6712
             1.6685,   1.6658,  1.6632,  1.6606,  1.6579,  1.6554,  1.6528,  1.6502,  1.6477,  1.6452
             1.6427,   1.6402,  1.6377,  1.6353,  1.6328,  1.6304,  1.6280,  1.6256,  1.6233,  1.6209
             1.6186,   1.6162,  1.6139,  1.6116,  1.6094,  1.6071,  1.6048,  1.6026,  1.6004,  1.5982
             1.5960,   1.5938,  1.5916,  1.5895,  1.5873,  1.5852,  1.5831,  1.5810,  1.5789,  1.5768
             1.5748,   1.5727,  1.5707,  1.5687,  1.5667,  1.5647,  1.5627,  1.5607,  1.5587,  1.5568
             1.5548,   1.5529,  1.5510,  1.5491,  1.5472,  1.5453,  1.5434,  1.5416,  1.5397,  1.5379
             1.5360,   1.5342,  1.5324,  1.5306,  1.5288,  1.5270,  1.5253,  1.5235,  1.5217,  1.5200
             1.5183,   1.5165,  1.5148,  1.5131,  1.5114,  1.5097,  1.5081,  1.5064,  1.5047,  1.5031
             1.5014,   1.4998,  1.4982,  1.4966,  1.4950,  1.4934,  1.4918,  1.4902,  1.4886,  1.4871
             1.4855,   1.4839,  1.4824,  1.4809,  1.4793,  1.4778,  1.4763,  1.4748,  1.4733,  1.4718
             1.4703,   1.4689,  1.4674,  1.4659,  1.4645,  1.4630,  1.4616,  1.4602,  1.4587,  1.4573
             1.4559,   1.4545,  1.4531,  1.4517,  1.4503,  1.4490,  1.4476,  1.4462,  1.4449,  1.4435
             1.4422,   1.4408,  1.4395,  1.4382,  1.4368,  1.4355,  1.4342,  1.4329,  1.4316,  1.4303
             1.4290,   1.4277,  1.4265,  1.4252,  1.4239,  1.4227,  1.4214,  1.4202,  1.4189,  1.4177
             1.4165,   1.4152,  1.4140,  1.4128,  1.4116,  1.4104,  1.4092,  1.4080,  1.4068,  1.4056
             1.4044,   1.4033,  1.4021,  1.4009,  1.3998,  1.3986,  1.3975,  1.3963,  1.3952,  1.3940
             1.3929,   1.3918,  1.3907,  1.3895,  1.3884,  1.3873,  1.3862,  1.3851,  1.3840,  1.3829
             1.3818,   1.3808,  1.3797,  1.3786,  1.3775,  1.3765,  1.3754,  1.3744,  1.3733,  1.3723
             1.3712,   1.3702,  1.3691,  1.3681,  1.3671,  1.3660,  1.3650,  1.3640,  1.3630,  1.3620
             1.3610,   1.3600,  1.3590,  1.3580,  1.3570,  1.3560,  1.3550,  1.3540,  1.3530,  1.3521
             1.3511,   1.3501,  1.3492,  1.3482,  1.3472,  1.3463,  1.3453,  1.3444,  1.3434,  1.3425
             1.3416,   1.3406,  1.3397,  1.3388,  1.3378,  1.3369,  1.3360,  1.3351,  1.3342,  1.3333
             1.3324,   1.3315,  1.3306,  1.3297,  1.3288,  1.3279,  1.3270,  1.3261,  1.3252,  1.3243
             1.3235,   1.3226,  1.3217,  1.3209,  1.3200,  1.3191,  1.3183,  1.3174,  1.3166,  1.3157
             1.3148,   1.3140,  1.3132,  1.3123,  1.3115,  1.3106,  1.3098,  1.3090,  1.3081,  1.3073
             1.3065,   1.3057,  1.3049,  1.3040,  1.3032,  1.3024,  1.3016,  1.3008,  1.3000,  1.2992
             1.2984,   1.2976,  1.2968,  1.2960,  1.2952,  1.2944,  1.2936,  1.2929,  1.2921,  1.2913
             1.2905,   1.2897,  1.2890,  1.2882,  1.2874,  1.2867,  1.2859,  1.2851,  1.2844,  1.2836
             1.2829,   1.2821,  1.2814,  1.2806,  1.2799,  1.2791,  1.2784,  1.2776,  1.2769,  1.2762
             1.2754,   1.2747,  1.2740,  1.2732,  1.2725,  1.2718,  1.2710,  1.2703,  1.2696,  1.2689
             1.2682,   1.2674,  1.2667,  1.2660,  1.2653,  1.2646,  1.2639,  1.2632,  1.2625,  1.2618
             1.2611,   1.2604,  1.2597,  1.2590,  1.2583,  1.2576,  1.2569,  1.2562,  1.2555,  1.2548
             1.2542,   1.2535,  1.2528,  1.2521,  1.2514,  1.2508,  1.2501,  1.2494,  1.2487,  1.2481
             1.2474,   1.2467,  1.2461,  1.2454,  1.2447,  1.2441,  1.2434,  1.2428,  1.2421,  1.2414
             1.2408,   1.2401,  1.2395,  1.2388,  1.2382,  1.2375,  1.2369,  1.2362,  1.2356,  1.2350
             1.2343,   1.2337,  1.2330,  1.2324,  1.2318,  1.2311,  1.2305,  1.2298,  1.2292,  1.2286
             1.2280,   1.2273,  1.2267,  1.2261,  1.2254,  1.2248,  1.2242,  1.2236,  1.2230,  1.2223
             1.2217,   1.2211,  1.2205,  1.2199,  1.2193,  1.2186,  1.2180,  1.2174,  1.2168,  1.2162
             1.2156,   1.2150,  1.2144,  1.2138,  1.2132,  1.2126,  1.2120,  1.2114,  1.2108,  1.2102
             1.2096,   1.2090,  1.2084,  1.2078,  1.2072,  1.2066,  1.2060,  1.2054,  1.2048,  1.2042
             1.2036,   1.2030,  1.2024,  1.2018,  1.2013,  1.2007,  1.2001,  1.1995,  1.1989,  1.1983
             1.1977,   1.1972,  1.1966,  1.1960,  1.1954,  1.1948,  1.1943,  1.1937,  1.1931,  1.1925
             1.1920,   1.1914,  1.1908,  1.1902,  1.1897,  1.1891,  1.1885,  1.1879,  1.1874,  1.1868
             1.1862,   1.1857,  1.1851,  1.1845,  1.1840,  1.1834,  1.1828,  1.1823,  1.1817,  1.1811
             1.1806,   1.1800,  1.1794,  1.1789,  1.1783,  1.1777,  1.1772,  1.1766,  1.1761,  1.1755
             1.1749,   1.1744,  1.1738,  1.1733,  1.1727,  1.1721,  1.1716,  1.1710,  1.1705,  1.1699
             1.1694,   1.1688,  1.1682,  1.1677,  1.1671,  1.1666,  1.1660,  1.1655,  1.1649,  1.1644
             1.1638,   1.1633,  1.1627,  1.1621,  1.1616,  1.1610,  1.1605,  1.1599,  1.1594,  1.1588
             1.1583,   1.1577,  1.1572,  1.1566,  1.1561,  1.1555,  1.1550,  1.1544,  1.1539,  1.1533
             1.1528,   1.1522,  1.1517,  1.1511,  1.1505,  1.1500,  1.1494,  1.1489,  1.1483,  1.1478
             1.1472,   1.1467,  1.1461,  1.1456,  1.1450,  1.1445,  1.1439,  1.1434,  1.1428,  1.1423
             1.1417,   1.1412,  1.1406,  1.1401,  1.1395,  1.1389,  1.1384,  1.1378,  1.1373,  1.1367
             1.1362,   1.1356,  1.1351,  1.1345,  1.1340,  1.1334,  1.1328,  1.1323,  1.1317,  1.1312
             1.1306,   1.1300,  1.1295,  1.1289,  1.1284,  1.1278,  1.1272,  1.1267,  1.1261,  1.1256
             1.1250,   1.1244,  1.1239,  1.1233,  1.1227,  1.1222,  1.1216,  1.1210,  1.1205,  1.1199
             1.1193,   1.1188,  1.1182,  1.1176,  1.1170,  1.1165,  1.1159,  1.1153,  1.1147,  1.1142
             1.1136,   1.1130,  1.1124,  1.1119,  1.1113,  1.1107,  1.1101,  1.1095,  1.1090,  1.1084
             1.1078,   1.1072,  1.1066,  1.1060,  1.1054,  1.1049,  1.1043,  1.1037,  1.1031,  1.1025
             1.1019,   1.1013,  1.1007,  1.1001,  1.0995,  1.0989,  1.0983,  1.0977,  1.0971,  1.0965
             1.0959,   1.0953,  1.0947,  1.0941,  1.0935,  1.0928,  1.0922,  1.0916,  1.0910,  1.0904
             1.0898,   1.0892,  1.0885,  1.0879,  1.0873,  1.0867,  1.0861,  1.0854,  1.0848,  1.0842
             1.0835,   1.0829,  1.0823,  1.0816,  1.0810,  1.0804,  1.0797,  1.0791,  1.0785,  1.0778
             1.0772,   1.0765,  1.0759,  1.0752,  1.0746,  1.0740,  1.0733,  1.0727,  1.0720,  1.0713
             1.0707,   1.0700,  1.0694,  1.0687,  1.0681,  1.0674,  1.0667,  1.0661,  1.0654,  1.0647
             1.0641,   1.0634,  1.0627,  1.0621,  1.0614,  1.0607,  1.0601,  1.0594,  1.0587,  1.0580
             1.0573,   1.0567,  1.0560,  1.0553,  1.0546,  1.0539,  1.0533,  1.0526,  1.0519,  1.0512
             1.0505,   1.0498,  1.0491,  1.0484,  1.0477,  1.0470,  1.0463,  1.0456,  1.0449,  1.0443
             1.0436,   1.0429,  1.0422,  1.0414,  1.0407,  1.0400,  1.0393,  1.0386,  1.0379,  1.0372
             1.0365,   1.0358,  1.0351,  1.0344,  1.0337,  1.0330,  1.0322,  1.0315,  1.0308,  1.0301
             1.0294,   1.0287,  1.0279,  1.0272,  1.0265,  1.0258,  1.0251,  1.0243,  1.0236,  1.0229
             1.0222,   1.0214,  1.0207,  1.0200,  1.0192,  1.0185,  1.0178,  1.0170,  1.0163,  1.0156
             1.0148,   1.0141,  1.0134,  1.0126,  1.0119,  1.0112,  1.0104,  1.0097,  1.0089,  1.0082
             1.0075,   1.0067,  1.0060,  1.0052,  1.0045,  1.0037,  1.0030,  1.0022,  1.0000,  1.0000
        ];
        rws = 0:0.01:0.99;
        sampleCounts = (1:size(data, 2)) - 1;
    end
    rw = max(min(rw, 0.99), 0);
    [~, row] = find(rw >= rws, 1, 'last');
    column = max(min(nSamples, sampleCounts(end)), sampleCounts(1)) + 1;
    correctionFactor = data(row, column);
end